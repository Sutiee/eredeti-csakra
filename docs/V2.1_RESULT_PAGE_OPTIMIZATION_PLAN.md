# v2.1 Result Page Mobile Optimization - V√âGLEGES TERV

**Verzi√≥**: v2.1
**D√°tum**: 2025-10-17
**St√°tusz**: J√≥v√°hagyva, implement√°ci√≥ el≈ëtt

---

## Executive Summary

A quiz eredm√©nyoldal mobil konverzi√≥j√°nak optimaliz√°l√°sa CRO best practices alapj√°n. F≈ë probl√©ma: 10,000px scroll depth mobilon, CTA el√©r√©se 95%-os g√∂rget√©sn√©l, magas elhagy√°si ar√°ny.

### V√°rhat√≥ eredm√©nyek (14 nap ut√°n)
- **Scroll depth to CTA**: 95% ‚Üí 75% (-20%)
- **Mobile conversion rate**: +40-55%
- **Above-fold engagement**: +25%
- **Trust signal CTR**: +3-5%

---

## 1. Probl√©ma defin√≠ci√≥

### Jelenlegi √°llapot
- **Mobile scroll depth**: 10,000px a CTA el√©r√©s√©hez
- **CTA poz√≠ci√≥**: 95%-os g√∂rget√©si m√©lys√©gn√©l
- **7 chakra k√°rtya**: Mind teljes terjedelemben megnyitva alap√©rtelmezetten (6000-8000px tartalom)
- **Kognit√≠v terhel√©s**: Information overload, d√∂nt√©si paral√≠zis
- **Bizalmi jelek**: Csak a lap alj√°n jelennek meg
- **Free vs Paid hat√°r**: Nem vil√°gos, mi az ingyenes eredm√©ny √©s mi a fizet≈ës

### C√©lcsoport specifikus probl√©m√°k (n≈ëk 35+)
- Mobil eszk√∂z haszn√°lat domin√°l
- Hossz√∫ tartalom ‚Üí gyors felad√°s
- Bizalmi jelek fontosak a v√°s√°rl√°si d√∂nt√©sben
- S√ºrg≈ëss√©g √©s "f√©lek, hogy lemaradok" √©rz√©s m≈±k√∂dik

---

## 2. Megold√°si strat√©gia (2025 CRO Best Practices)

### A) Above-the-fold FREE Summary
**C√©l**: Azonnal √©rt√©ket adni, kontextust teremteni a fizet≈ës aj√°nlathoz

**Mit mutat**:
- **1 legfontosabb chakra k√°rtya** (legnagyobb blokk = legt√∂bb fejleszt√©si potenci√°l)
- **Pozit√≠v micro-copy**: "Itt tudsz ma a legt√∂bbet jav√≠tani"
- **1 gyors tennival√≥/tipp**: Azonnal alkalmazhat√≥
- **Fallback logika**: Ha nincs egy√©rtelm≈± legrosszabb ‚Üí Gy√∂k√©rcsakra (univerz√°lis alapoz√°s)

**Poz√≠ci√≥**: Hero szekci√≥ ut√°n, silhouette el≈ëtt

---

### B) Soft-Upsell Box (Top poz√≠ci√≥)
**C√©l**: Kor√°n felkelteni az √©rdekl≈ëd√©st a fizet≈ës csomag ir√°nt, kontextust adni

**Tartalom**:
- **C√≠m**: "Mit kapsz a teljes tervben?"
- **3 ikon-√©rt√©k bullet**:
  - üìñ Heti szem√©lyre szabott gyakorlatok
  - üí´ Meger≈ës√≠t≈ë affirm√°ci√≥k mindennapi haszn√°latra
  - üéß 7 vezetett csakra medit√°ci√≥ (70+ perc)
- **Mini √°rhorgony**: "Teljes √©rt√©ke: 24,970 Ft ‚Üí Ma: 6,990 Ft"
- **CTA gomb**: "Megn√©zem, mit kapok" (smooth scroll to pricing section)

**Poz√≠ci√≥**: FreeChakraSummary alatt k√∂zvetlen

**A/B teszt terv** (k√©s≈ëbbi):
- **Verzi√≥ A (Control)**: Top poz√≠ci√≥ (free summary alatt)
- **Verzi√≥ B (Treatment)**: Bottom poz√≠ci√≥ (free szakasz v√©g√©n, accordion ut√°n)
- **M√©r≈ësz√°m**: soft_upsell_click CTR ‚Üí checkout_start ‚Üí purchase conversion

---

### C) Mobile Accordion Pattern
**C√©l**: Scroll depth radik√°lis cs√∂kkent√©se, progressz√≠v inform√°ci√≥k√∂zl√©s

**M≈±k√∂d√©s**:
- **Alap√©rtelmezett √°llapot**: 0 nyitott k√°rtya (clean, overview)
- **Multiple cards open**: Egyszerre t√∂bb k√°rtya is nyithat√≥ (√∂sszehasonl√≠t√°s lehet≈ës√©ge)
- **Expand anim√°ci√≥**: Framer Motion `height: auto` smooth transition
- **Visual feedback**: Chevron ikon forg√°s, sz√≠nv√°ltoz√°s kattint√°skor

**A/B teszt terv** (k√©s≈ëbbi):
- **Verzi√≥ A (Control)**: 0 nyitott k√°rtya
- **Verzi√≥ B (Treatment)**: 1 "top blokk" (legnagyobb probl√©ma) automatikusan nyitva
- **M√©r≈ësz√°m**: accordion_open esem√©nyek sz√°ma, tov√°bb g√∂rget√©s ar√°nya

**Desktop**: Jelenlegi viselked√©s megmarad (all-expanded)

---

### D) Sticky Bottom CTA
**C√©l**: CTA folyamatos el√©rhet≈ës√©ge g√∂rget√©s k√∂zben, impulz√≠v v√°s√°rl√°s √∂szt√∂nz√©se

**Trigger**: 30% scroll depth (viewport alapon sz√°molva)

**Dinamikus copy logika**:
```typescript
if (blockedChakrasCount >= 3) {
  ctaCopy = "Egyens√∫lyt k√©rek"
} else if (blockedChakrasCount >= 1) {
  ctaCopy = "Tervet k√©rek"
} else {
  ctaCopy = "Harm√≥nia ≈ërz√©se"
}
```

**Pre-header**:
- 1 ikon (‚ú®) + r√∂vid haszon: "+ medit√°ci√≥k ma"
- C√©lja: +3-5% CTR n√∂vel√©s

**Visual Design**:
- Fixed bottom, z-50, full width
- Slide-up animation (Framer Motion)
- Backdrop blur (glass morphism)
- Dismissible: X gomb jobb fels≈ë sarokban
- Dismissed state ‚Üí localStorage perzisztencia (24h)

**A/B teszt terv** (k√©s≈ëbbi):
- **Verzi√≥ A (Control)**: 30% scroll trigger
- **Verzi√≥ B (Treatment)**: 12 m√°sodperc id≈ëalap√∫ trigger
- **M√©r≈ësz√°m**: sticky_show ‚Üí sticky_click ‚Üí checkout_start min≈ës√©gi konverzi√≥

---

### E) Multi-CTA Strat√©gia
**C√©l**: K√ºl√∂nb√∂z≈ë d√∂nt√©si pontokban k√ºl√∂nb√∂z≈ë t√≠pus√∫ usereket elkapni

**3 CTA tier**:
1. **Hero CTA**: Azonnali d√∂nt√©shoz√≥knak (impulz√≠v, magabiztos)
2. **Sticky CTA**: Browsing k√∂zben felmer√ºl≈ë √©rdekl≈ëd√©s (30%+ scroll)
3. **Micro CTAs**: Chakra k√°rty√°k k√∂z√∂tt elhelyezett mini gombok ("R√©szletes terv kell? ‚Üí")

**V√°rhat√≥ eredm√©ny**: +30-40% combined conversion (t√∂bb bel√©p√©si pont)

---

### F) In-Content Trust Badges
**C√©l**: Folyamatos bizalom√©p√≠t√©s, ne csak a v√©g√©n jelenj√©k meg

**Badge t√≠pusok**:
- üõ°Ô∏è "14 nap p√©nzvisszafizet√©si garancia"
- üí≥ "Stripe biztons√°gos fizet√©s"
- üîí "SSL titkos√≠t√°s"
- ‚≠ê "4.9/5 (347 √©rt√©kel√©s)"
- üë• "2,000+ magyar n≈ë kipr√≥b√°lta"

**Poz√≠ci√≥**: Chakra accordion k√°rty√°k k√∂z√∂tt sz√≥rva (minden 2-3. k√°rtya ut√°n)

**Visual Design**: Chip/badge design, nem t√∫l domin√°ns, `bg-white/10 backdrop-blur-sm`

---

### G) Pricing Decoy Strat√©gia
**C√©l**: K√∂z√©ps≈ë csomag (Bundle) konverzi√≥j√°nak maximaliz√°l√°sa

**3 k√°rty√°s pricing layout**:

| Csomag | √År | Tartalom | Decoy szerepe |
|--------|-----|----------|---------------|
| **PDF Elemz√©s** | 2,990 Ft | Szem√©lyre szabott PDF jelent√©s | Entry point, de "sz≈±k√≠tett √©rt√©k" (nincs medit√°ci√≥) |
| **AJ√ÅNLOTT: Bundle** | 6,990 Ft | PDF + K√©zik√∂nyv + 7 Medit√°ci√≥ (70+ perc) | **TARGET** - vizu√°lis kiemel√©s, legjobb √©rt√©k |
| **Pr√©mium** (k√©s≈ëbb) | 12,990 Ft | Bundle + 1:1 mini konzult√°ci√≥ (30 perc) | Anchor, Bundle-t olcs√≥bbnak mutatja |

**Vizu√°lis kiemel√©s (Bundle)**:
- `bg-spiritual-gold-500` "AJ√ÅNLOTT" s√°v a k√°rtya tetej√©n
- 105% scale mobilon (`scale-105 transform`)
- Extra kontraszt√∫ border: `border-2 border-spiritual-gold-400`
- Lista√°r √°th√∫zva ‚Üí Mai √°r kiemelve
- B√≥nuszok √©rt√©ke ki√≠rva: "Teljes √©rt√©ke: 24,970 Ft"

**Fontos**: K√©zik√∂nyv √©s Medit√°ci√≥k √∂n√°ll√≥k√©nt NE jelenjenek meg a landingen (csak admin/bolt oldalon), hogy ne kannibaliz√°lj√°k a Bundle-t.

---

## 3. Komponens architekt√∫ra

### A) √öJ komponensek

#### 1. `FreeChakraSummary.tsx` (300-400 sor)
```typescript
type FreeChakraSummaryProps = {
  chakraScores: ChakraScores;
  chakraInterpretations: ChakraInterpretation[];
}

// Logika:
// 1. Find legnagyobb blokk (legalacsonyabb pontsz√°m)
// 2. Ha tie ‚Üí Gy√∂k√©rcsakra fallback
// 3. Render 1 k√°rtya pozit√≠v keretez√©ssel
// 4. 1 gyors tennival√≥/tipp megjelen√≠t√©se
// 5. "N√©zd meg a teljes tervet" smooth scroll link
```

**Poz√≠ci√≥**: `app/eredmeny/[id]/page.tsx` Hero ut√°n besz√∫rva

---

#### 2. `SoftUpsellBox.tsx` (150-200 sor)
```typescript
type SoftUpsellBoxProps = {
  position?: 'top' | 'bottom'; // A/B teszthez
  onCtaClick: (position: string) => void; // Analytics
}

// Tartalom:
// - C√≠m: "Mit kapsz a teljes tervben?"
// - 3 bullet ikon + sz√∂veg
// - Mini √°rhorgony
// - CTA gomb smooth scroll to pricing
// - onClick ‚Üí softupsell_click event tracking
```

**Poz√≠ci√≥**: FreeChakraSummary ut√°n (top), vagy accordion ut√°n (bottom - k√©s≈ëbb A/B)

---

#### 3. `StickyCTA.tsx` (200-250 sor)
```typescript
type StickyCtaProps = {
  blockedChakrasCount: number;
  trigger?: 'scroll' | 'time'; // A/B teszthez
  triggerValue?: number; // 30% vagy 12s
  onCtaClick: (copyVariant: string) => void;
}

// √Ållapot:
// - const [showSticky, setShowSticky] = useState(false)
// - const [isDismissed, setIsDismissed] = useState(false)
// - useEffect scroll listener vagy time-based trigger
// - localStorage check: dismissed_sticky_cta_v21

// Dinamikus copy:
// - blockedChakrasCount >= 3 ‚Üí "Egyens√∫lyt k√©rek"
// - blockedChakrasCount 1-2 ‚Üí "Tervet k√©rek"
// - blockedChakrasCount 0 ‚Üí "Harm√≥nia ≈ërz√©se"

// Pre-header:
// - "‚ú® + medit√°ci√≥k ma" text

// Animation:
// - Framer Motion initial={{ y: 100, opacity: 0 }}
// - animate={{ y: showSticky ? 0 : 100, opacity: showSticky ? 1 : 0 }}
```

**Poz√≠ci√≥**: Fixed bottom, z-50, full width

---

#### 4. `InContentTrustBadge.tsx` (100-150 sor)
```typescript
type TrustBadgeProps = {
  type: 'guarantee' | 'stripe' | 'ssl' | 'rating' | 'social-proof';
}

// Badge vari√°nsok:
// - guarantee: "üõ°Ô∏è 14 nap p√©nzvisszafizet√©s"
// - stripe: "üí≥ Stripe biztons√°gos fizet√©s"
// - ssl: "üîí SSL titkos√≠t√°s"
// - rating: "‚≠ê 4.9/5 (347 √©rt√©kel√©s)"
// - social-proof: "üë• 2,000+ magyar n≈ë kipr√≥b√°lta"

// Visual: chip design, backdrop-blur-sm, subtle
```

**Poz√≠ci√≥**: Chakra k√°rty√°k k√∂z√∂tt sz√≥rva (page.tsx)

---

#### 5. `MobileChakraAccordion.tsx` (350-450 sor)
```typescript
type MobileChakraAccordionProps = {
  chakraInterpretations: ChakraInterpretation[];
  defaultOpenIndex?: number | null; // A/B: null vs 0
  onCardToggle: (chakra: string, position: number, isOpen: boolean) => void;
}

// √Ållapot:
// - const [expandedCards, setExpandedCards] = useState<string[]>([])
// - Multiple cards open: add/remove from array

// Chakra k√°rtya komponens:
// - Header: Chakra n√©v + pontsz√°m badge + chevron ikon
// - Content: Framer Motion AnimatePresence
//   - initial={{ height: 0, opacity: 0 }}
//   - animate={{ height: isExpanded ? 'auto' : 0, opacity: isExpanded ? 1 : 0 }}
//   - transition={{ duration: 0.3, ease: 'easeInOut' }}
// - Manifestations + First Aid Plan

// onClick ‚Üí accordion_open event tracking
```

**Poz√≠ci√≥**: `ChakraCards.tsx` helyett renderelve mobilon (<768px)

---

#### 6. `PricingSection.tsx` (400-500 sor)
```typescript
type PricingSectionProps = {
  onProductSelect: (productId: string, isDecoy: boolean) => void;
}

// 3 k√°rty√°s layout:
// - PDF (2990 Ft) - Entry point
// - AJ√ÅNLOTT Bundle (6990 Ft) - TARGET DECOY
//   - scale-105 transform
//   - border-2 border-spiritual-gold-400
//   - bg-spiritual-gold-500 "AJ√ÅNLOTT" s√°v tetej√©n
//   - Lista√°r √°th√∫zva: "24,970 Ft"
//   - Mai √°r: "6,990 Ft"
//   - B√≥nuszok lista
// - Pr√©mium (k√©s≈ëbbi: Bundle + konzult√°ci√≥)

// onClick ‚Üí pricing_select event tracking
```

**Poz√≠ci√≥**: `app/eredmeny/[id]/page.tsx` CTA section helyett/mellett

---

### B) M√ìDOS√çTOTT komponensek

#### 1. `app/eredmeny/[id]/page.tsx`
**V√°ltoz√°sok**:
- Hero ut√°n besz√∫r√°s: `<FreeChakraSummary>` + `<SoftUpsellBox>`
- ChakraSilhouette poz√≠ci√≥ lejjebb ker√ºl
- ChakraCards section helyett responsive logic:
  - Desktop: `<ChakraCards>` (jelenlegi)
  - Mobile: `<MobileChakraAccordion>`
- Chakra k√°rty√°k k√∂z√∂tt `<InContentTrustBadge>` komponensek besz√∫r√°sa (minden 2-3. k√°rtya ut√°n)
- CTA section felv√°lt√°sa/kieg√©sz√≠t√©se `<PricingSection>` komponenssel
- `<StickyCTA>` besz√∫r√°sa lap v√©g√©n (fixed positioning miatt b√°rhol lehet)

---

#### 2. `components/result/ChakraSilhouette.tsx`
**V√°ltoz√°sok**:
- Responsive sizing m√≥dos√≠t√°s:
```typescript
// EL≈êTTE:
<div className="max-w-md mx-auto">

// UT√ÅNA:
<div className="max-w-[280px] md:max-w-md mx-auto">
```
- Scroll-to funkci√≥ megmarad
- Interactive glow effects megmaradnak

---

#### 3. `components/result/ChakraCards.tsx`
**V√°ltoz√°sok**:
- Desktop rendering megmarad (all-expanded)
- Mobile (<768px): NE renderel≈ëdj√∂n, helyette `<MobileChakraAccordion>` a page.tsx-ban

```typescript
// Responsive logic page.tsx-ban:
<div className="hidden md:block">
  <ChakraCards interpretations={interpretations} />
</div>
<div className="block md:hidden">
  <MobileChakraAccordion interpretations={interpretations} />
</div>
```

---

## 4. Event Tracking & Analytics

### A) Eszk√∂z√∂k

**Kombin√°ci√≥**: Plausible + Supabase events t√°bla

1. **Plausible**:
   - Alap pageview, CTR, bounce rate
   - Privacy-bar√°t, GDPR compliant
   - Lightweight script

2. **Supabase `analytics_events` t√°bla**:
   - R√©szletes funnel tracking
   - Custom properties JSON field
   - Lek√©rdezhet≈ë SQL-lel
   - Real-time dashboard lehet≈ës√©g

---

### B) Event s√©ma

#### Supabase `analytics_events` t√°bla strukt√∫ra
```sql
CREATE TABLE analytics_events (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  result_id UUID REFERENCES quiz_results(id),
  event_name TEXT NOT NULL,
  properties JSONB,
  session_id TEXT,
  user_agent TEXT,
  device_type TEXT, -- 'mobile' | 'tablet' | 'desktop'
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

CREATE INDEX idx_events_result ON analytics_events(result_id);
CREATE INDEX idx_events_name ON analytics_events(event_name);
CREATE INDEX idx_events_created ON analytics_events(created_at);
```

---

#### Event t√≠pusok √©s properties

**1. `accordion_open`**
```typescript
{
  event_name: 'accordion_open',
  properties: {
    chakra: 'Gy√∂k√©rcsakra',
    position: 0, // 0-6
    score: 8,
    interpretation_level: 'imbalanced'
  }
}
```

**2. `sticky_show`**
```typescript
{
  event_name: 'sticky_show',
  properties: {
    trigger: 'scroll', // 'scroll' | 'time'
    trigger_value: 30, // % vagy m√°sodperc
    scroll_depth_px: 1200
  }
}
```

**3. `sticky_click`**
```typescript
{
  event_name: 'sticky_click',
  properties: {
    copy_variant: 'Egyens√∫lyt k√©rek',
    blocked_count: 3,
    scroll_depth: 45 // %
  }
}
```

**4. `softupsell_click`**
```typescript
{
  event_name: 'softupsell_click',
  properties: {
    position: 'top', // 'top' | 'bottom'
    time_on_page: 32 // m√°sodperc
  }
}
```

**5. `pricing_select`**
```typescript
{
  event_name: 'pricing_select',
  properties: {
    product_id: 'bundle_complete',
    is_decoy: true, // k√∂z√©ps≈ë "AJ√ÅNLOTT" csomag
    price: 6990,
    scroll_depth: 78 // %
  }
}
```

**6. `checkout_start`**
```typescript
{
  event_name: 'checkout_start',
  properties: {
    product_id: 'bundle_complete',
    source: 'sticky', // 'hero' | 'sticky' | 'micro'
    funnel_time: 145 // m√°sodperc az eredm√©nyoldal bet√∂lt√©s√©t≈ël
  }
}
```

**7. `purchase`**
```typescript
{
  event_name: 'purchase',
  properties: {
    product_id: 'bundle_complete',
    amount: 6990,
    currency: 'HUF',
    funnel_time: 298, // m√°sodperc teljes quiz ‚Üí v√°s√°rl√°s
    source: 'sticky'
  }
}
```

---

### C) Analytics utility f√ºggv√©nyek

**√öj f√°jl**: `/lib/analytics/track-event.ts`

```typescript
import { createClient } from '@supabase/supabase-js';

type EventName =
  | 'accordion_open'
  | 'sticky_show'
  | 'sticky_click'
  | 'softupsell_click'
  | 'pricing_select'
  | 'checkout_start'
  | 'purchase';

type EventProperties = Record<string, any>;

export async function trackEvent(
  resultId: string,
  eventName: EventName,
  properties: EventProperties = {}
) {
  try {
    // Supabase tracking
    const supabase = createClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
    );

    const { error } = await supabase.from('analytics_events').insert({
      result_id: resultId,
      event_name: eventName,
      properties,
      session_id: getSessionId(), // localStorage-based
      user_agent: navigator.userAgent,
      device_type: getDeviceType(),
    });

    if (error) {
      console.error('[Analytics] Supabase error:', error);
    }

    // Plausible custom event
    if (typeof window !== 'undefined' && (window as any).plausible) {
      (window as any).plausible(eventName, { props: properties });
    }
  } catch (err) {
    console.error('[Analytics] Track error:', err);
  }
}

function getSessionId(): string {
  if (typeof window === 'undefined') return '';
  let sessionId = localStorage.getItem('session_id');
  if (!sessionId) {
    sessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    localStorage.setItem('session_id', sessionId);
  }
  return sessionId;
}

function getDeviceType(): 'mobile' | 'tablet' | 'desktop' {
  if (typeof window === 'undefined') return 'desktop';
  const width = window.innerWidth;
  if (width < 768) return 'mobile';
  if (width < 1024) return 'tablet';
  return 'desktop';
}
```

**Haszn√°lat komponensekben**:
```typescript
import { trackEvent } from '@/lib/analytics/track-event';

// MobileChakraAccordion.tsx
const handleCardToggle = (chakra: ChakraInterpretation, index: number) => {
  const isNowExpanded = !expandedCards.includes(chakra.name);

  if (isNowExpanded) {
    trackEvent(resultId, 'accordion_open', {
      chakra: chakra.name,
      position: index,
      score: chakra.score,
      interpretation_level: chakra.level,
    });
  }

  // ... toggle logic
};
```

---

## 5. A/B Teszt Infrastrukt√∫ra

### A) Platform: Vercel Edge Config

**Indokl√°s**:
- CDN-szint≈± konfigur√°ci√≥ (ultra gyors)
- Real-time friss√≠t√©s (nincs deployment)
- 2 verzi√≥ elegend≈ë most (Control vs Treatment)
- Lightweight, nincs k√ºls≈ë dependency

---

### B) Edge Config setup

**1. Vercel dashboard**:
- Projekt ‚Üí Settings ‚Üí Edge Config ‚Üí Create
- Config name: `eredeti-csakra-ab-tests`

**2. Environment variable**:
```bash
EDGE_CONFIG=https://edge-config.vercel.com/xxx
```

**3. Edge Config JSON**:
```json
{
  "v21_sticky_trigger": {
    "enabled": true,
    "variants": {
      "control": { "type": "scroll", "value": 30 },
      "treatment": { "type": "time", "value": 12 }
    },
    "traffic_split": { "control": 50, "treatment": 50 }
  },
  "v21_accordion_default": {
    "enabled": false,
    "variants": {
      "control": { "open_count": 0 },
      "treatment": { "open_count": 1, "open_index": 0 }
    },
    "traffic_split": { "control": 50, "treatment": 50 }
  },
  "v21_softupsell_position": {
    "enabled": false,
    "variants": {
      "control": { "position": "top" },
      "treatment": { "position": "bottom" }
    },
    "traffic_split": { "control": 50, "treatment": 50 }
  }
}
```

---

### C) A/B Hook implementation

**√öj f√°jl**: `/lib/ab-testing/use-ab-variant.ts`

```typescript
import { useEffect, useState } from 'react';

type VariantConfig = {
  enabled: boolean;
  variants: Record<string, any>;
  traffic_split: Record<string, number>;
};

export function useAbVariant(testName: string): string {
  const [variant, setVariant] = useState<string>('control');

  useEffect(() => {
    // 1. Check localStorage for persistent assignment
    const storageKey = `ab_${testName}`;
    const stored = localStorage.getItem(storageKey);

    if (stored) {
      setVariant(stored);
      return;
    }

    // 2. Check URL param (?ab_sticky_trigger=treatment)
    const urlParams = new URLSearchParams(window.location.search);
    const urlVariant = urlParams.get(`ab_${testName}`);

    if (urlVariant) {
      setVariant(urlVariant);
      localStorage.setItem(storageKey, urlVariant);
      return;
    }

    // 3. Fetch from Edge Config (or fallback to default)
    fetchAbConfig(testName).then(config => {
      if (!config.enabled) {
        setVariant('control');
        return;
      }

      // Random assignment based on traffic split
      const assigned = assignVariant(config.traffic_split);
      setVariant(assigned);
      localStorage.setItem(storageKey, assigned);
    });
  }, [testName]);

  return variant;
}

async function fetchAbConfig(testName: string): Promise<VariantConfig> {
  try {
    // Fallback: hardcoded default (Edge Config k√©s≈ëbb j√∂n)
    return {
      enabled: false,
      variants: { control: {}, treatment: {} },
      traffic_split: { control: 100, treatment: 0 },
    };
  } catch (err) {
    console.error('[A/B] Fetch error:', err);
    return {
      enabled: false,
      variants: { control: {} },
      traffic_split: { control: 100 },
    };
  }
}

function assignVariant(split: Record<string, number>): string {
  const random = Math.random() * 100;
  let cumulative = 0;

  for (const [variant, percentage] of Object.entries(split)) {
    cumulative += percentage;
    if (random < cumulative) {
      return variant;
    }
  }

  return 'control';
}
```

**Haszn√°lat komponensekben**:
```typescript
// StickyCTA.tsx
import { useAbVariant } from '@/lib/ab-testing/use-ab-variant';

export function StickyCTA({ blockedChakrasCount }: StickyCtaProps) {
  const variant = useAbVariant('v21_sticky_trigger');

  const trigger = variant === 'treatment' ? 'time' : 'scroll';
  const triggerValue = variant === 'treatment' ? 12 : 30;

  // ... sticky logic
}
```

---

### D) A/B Teszt √ºtemez√©s

**Kezd√©s (Week 1-2)**: Nincs A/B teszt
- Csak Treatment verzi√≥ megy √©lesbe (√∫j komponensek)
- Baseline m√©r√©s: conversion rate, scroll depth, CTR
- Stability monitoring

**Week 3-4**: Els≈ë A/B teszt (Sticky trigger)
- **Control**: 30% scroll
- **Treatment**: 12s id≈ë alap√∫
- Traffic split: 50/50
- M√©r≈ësz√°m: sticky_show ‚Üí sticky_click ‚Üí checkout_start konverzi√≥

**Week 5-6**: M√°sodik A/B teszt (Accordion default)
- **Control**: 0 nyitott k√°rtya
- **Treatment**: 1 top blokk nyitva
- M√©r≈ësz√°m: accordion_open esem√©nyek sz√°ma, tov√°bb g√∂rget√©s ar√°nya

**Week 7-8**: Harmadik A/B teszt (Soft-upsell poz√≠ci√≥)
- **Control**: Top (free summary alatt)
- **Treatment**: Bottom (accordion ut√°n)
- M√©r≈ësz√°m: softupsell_click CTR ‚Üí pricing_select

---

## 6. Implement√°ci√≥s Roadmap

### Phase 1: Core UX (2-3 nap) - HIGH PRIORITY

**1.1 Free Summary komponens**
- [ ] `/components/result/FreeChakraSummary.tsx` l√©trehoz√°sa
- [ ] Legnagyobb blokk logika implement√°l√°sa (fallback: Gy√∂k√©rcsakra)
- [ ] Pozit√≠v micro-copy: "Itt tudsz ma a legt√∂bbet jav√≠tani"
- [ ] 1 gyors tennival√≥/tipp megjelen√≠t√©se
- [ ] "N√©zd meg a teljes tervet" smooth scroll link
- [ ] Responsive design (mobile-first)

**1.2 Soft-Upsell Box komponens**
- [ ] `/components/result/SoftUpsellBox.tsx` l√©trehoz√°sa
- [ ] 3 bullet ikon + sz√∂veg
- [ ] Mini √°rhorgony: "24,970 Ft ‚Üí 6,990 Ft"
- [ ] CTA gomb: "Megn√©zem, mit kapok"
- [ ] Smooth scroll to pricing implement√°l√°sa
- [ ] Analytics tracking: `softupsell_click`

**1.3 Result page layout m√≥dos√≠t√°s**
- [ ] `/app/eredmeny/[id]/page.tsx` m√≥dos√≠t√°sa
- [ ] Hero ut√°n besz√∫r√°s: `<FreeChakraSummary>` + `<SoftUpsellBox>`
- [ ] Silhouette poz√≠ci√≥ lejjebb mozgat√°sa
- [ ] Layout spacing finomhangol√°s

**1.4 Silhouette responsive sizing**
- [ ] `/components/result/ChakraSilhouette.tsx` m√≥dos√≠t√°sa
- [ ] `max-w-[280px] md:max-w-md` oszt√°ly hozz√°ad√°sa
- [ ] Visual regression teszt (desktop is rendben van)

---

### Phase 2: Conversion Boosters (2 nap) - HIGH PRIORITY

**2.1 Sticky CTA komponens**
- [ ] `/components/result/StickyCTA.tsx` l√©trehoz√°sa
- [ ] 30% scroll trigger logic (useEffect + scroll listener)
- [ ] Dinamikus copy: blockedChakrasCount alapj√°n
- [ ] Pre-header: "‚ú® + medit√°ci√≥k ma"
- [ ] Framer Motion slide-up anim√°ci√≥
- [ ] Dismiss funkci√≥ + localStorage perzisztencia
- [ ] Analytics tracking: `sticky_show`, `sticky_click`

**2.2 Pricing Section decoy design**
- [ ] `/components/result/PricingSection.tsx` l√©trehoz√°sa VAGY
- [ ] Megl√©v≈ë pricing m√≥dos√≠t√°sa decoy strat√©gi√°val
- [ ] 3 k√°rty√°s layout: PDF | Bundle (AJ√ÅNLOTT) | Pr√©mium
- [ ] Bundle vizu√°lis kiemel√©s:
  - [ ] `bg-spiritual-gold-500` "AJ√ÅNLOTT" s√°v
  - [ ] `scale-105` transform mobilon
  - [ ] `border-2 border-spiritual-gold-400`
  - [ ] Lista√°r √°th√∫zva: "24,970 Ft"
- [ ] Analytics tracking: `pricing_select`

**2.3 In-Content Trust Badges**
- [ ] `/components/result/InContentTrustBadge.tsx` l√©trehoz√°sa
- [ ] 5 badge t√≠pus implement√°l√°sa (guarantee, stripe, ssl, rating, social-proof)
- [ ] Chip design: `bg-white/10 backdrop-blur-sm`
- [ ] Result page-be besz√∫r√°s: minden 2-3. chakra k√°rtya ut√°n

---

### Phase 3: Mobile Optimization (2 nap) - MEDIUM PRIORITY

**3.1 Mobile Accordion komponens**
- [ ] `/components/result/MobileChakraAccordion.tsx` l√©trehoz√°sa
- [ ] useState: `expandedCards` array (multiple open support)
- [ ] Toggle logic: add/remove from array
- [ ] Framer Motion AnimatePresence:
  - [ ] `height: auto` smooth transition
  - [ ] Chevron ikon forg√°s anim√°ci√≥
- [ ] Analytics tracking: `accordion_open`
- [ ] Default state: 0 nyitott k√°rtya

**3.2 Responsive logic ChakraCards**
- [ ] `/components/result/ChakraCards.tsx` m√≥dos√≠t√°sa
- [ ] Desktop: Jelenlegi all-expanded megmarad
- [ ] Mobile: NE renderel≈ëdj√∂n
- [ ] Result page.tsx: Responsive conditional rendering
  ```tsx
  <div className="hidden md:block">
    <ChakraCards />
  </div>
  <div className="block md:hidden">
    <MobileChakraAccordion />
  </div>
  ```

**3.3 Animation polishing**
- [ ] Framer Motion transitions finomhangol√°sa
- [ ] Entrance animations (staggered reveal)
- [ ] Scroll-triggered animations (optional)
- [ ] Performance teszt (60 FPS target)

---

### Phase 4: Tracking & A/B Setup (1 nap) - LOW PRIORITY

**4.1 Supabase analytics t√°bl√°k**
- [ ] `analytics_events` t√°bla l√©trehoz√°sa (SQL migration)
- [ ] Indexek hozz√°ad√°sa: result_id, event_name, created_at
- [ ] RLS policy: public insert (anonymous tracking)

**4.2 Analytics utility**
- [ ] `/lib/analytics/track-event.ts` l√©trehoz√°sa
- [ ] Supabase insert logic
- [ ] Plausible custom event integration
- [ ] Session ID gener√°l√°s (localStorage)
- [ ] Device type detection

**4.3 Event tracking implement√°l√°s**
- [ ] Minden komponensbe analytics hook besz√∫r√°sa:
  - [ ] `FreeChakraSummary` (nincs egyedi event, csak pageview)
  - [ ] `SoftUpsellBox` ‚Üí `softupsell_click`
  - [ ] `StickyCTA` ‚Üí `sticky_show`, `sticky_click`
  - [ ] `MobileChakraAccordion` ‚Üí `accordion_open`
  - [ ] `PricingSection` ‚Üí `pricing_select`
  - [ ] Checkout page ‚Üí `checkout_start`
  - [ ] Success page ‚Üí `purchase`

**4.4 A/B Testing infrastrukt√∫ra (K√âS≈êBBI)**
- [ ] Vercel Edge Config l√©trehoz√°sa (dashboard)
- [ ] Environment variable: `EDGE_CONFIG`
- [ ] `/lib/ab-testing/use-ab-variant.ts` hook l√©trehoz√°sa
- [ ] localStorage persistence logic
- [ ] URL param override (?ab_test=treatment)
- [ ] Edge Config JSON config felt√∂lt√©se

**4.5 Plausible setup**
- [ ] Plausible script hozz√°ad√°sa `app/layout.tsx`-hoz
- [ ] Custom events enged√©lyez√©se Plausible dashboardon
- [ ] Goal tracking setup: `checkout_start`, `purchase`

---

### Phase 5: Testing & Refinement (1 nap) - CRITICAL

**5.1 Manual QA**
- [ ] Mobile teszt (Chrome DevTools + real device):
  - [ ] iPhone 13 Pro (390x844)
  - [ ] Samsung Galaxy S21 (360x800)
  - [ ] Scroll depth m√©r√©s (DevTools ‚Üí Performance)
- [ ] Tablet teszt (iPad 768x1024)
- [ ] Desktop teszt (1920x1080)
- [ ] Cross-browser: Safari, Chrome, Firefox

**5.2 Analytics validation**
- [ ] Supabase t√°bl√°zat: Events beker√ºlnek-e?
- [ ] Plausible dashboard: Custom events megjelennek-e?
- [ ] Event properties helyes form√°tum-e?

**5.3 Performance audit**
- [ ] Lighthouse mobile score (target: 90+)
- [ ] LCP < 2.5s (hero + free summary bet√∂lt√©s)
- [ ] CLS < 0.1 (layout shifts elker√ºl√©se)
- [ ] TBT < 200ms (Framer Motion optimaliz√°l√°s)

**5.4 Visual regression**
- [ ] Desktop layout nem t√∂rt el?
- [ ] Spiritual sz√≠npaletta megmaradt?
- [ ] Typography consistency (Playfair + Inter)

**5.5 Bug fixes & polish**
- [ ] TypeScript hib√°k jav√≠t√°sa (`npm run type-check`)
- [ ] ESLint warnings jav√≠t√°sa
- [ ] Accessibility audit (ARIA labels, keyboard nav)

---

## 7. M√©r≈ësz√°mok & Success Criteria

### A) Baseline (jelenlegi √°llapot - m√©r√©s sz√ºks√©ges)

**K√©rd√©sek a usernek**:
1. Jelenlegi mobile conversion rate az eredm√©nyoldalon? (%)
2. Bounce rate eredm√©nyoldal mobilon? (%)
3. Average scroll depth mobilon? (%)
4. √Åtlagos id≈ë az eredm√©nyoldalon? (m√°sodperc)

**Becs√ºlt baseline** (ha nincs adat):
- Mobile conversion: ~8-12%
- Bounce rate: ~45-55%
- Average scroll depth: ~60-70%
- Time on page: ~90-120s

---

### B) C√©lok (14 nap ut√°n)

| Metrika | Baseline | C√©l | V√°ltoz√°s |
|---------|----------|-----|----------|
| **Mobile scroll to CTA** | 95% | 75% | -20% |
| **Mobile conversion rate** | 10% | 14-16% | +40-60% |
| **Bounce rate (result page)** | 50% | 35% | -30% |
| **Average scroll depth** | 65% | 80% | +15% |
| **Time on page** | 100s | 140s | +40% |
| **Soft-upsell CTR** | - | 15-25% | NEW |
| **Sticky CTA show rate** | - | 70%+ | NEW |
| **Sticky CTA click rate** | - | 8-12% | NEW |
| **Pricing decoy (Bundle) click** | - | 50%+ | NEW |

---

### C) Micro m√©r≈ësz√°mok (event tracking)

**Engagement metrics**:
- `accordion_open` √°tlag: 3-4 k√°rtya / user
- `softupsell_click` CTR: 15-25%
- `sticky_show`: 70%+ l√°that√≥s√°g
- `sticky_click`: 8-12% CTR (sticky-b√≥l checkout)

**Conversion funnel**:
```
Result page visit (100%)
  ‚Üì
Soft-upsell click (15-25%)
  ‚Üì
Pricing section scroll (80%)
  ‚Üì
Pricing card select (60%)
  ‚Üì
Checkout start (40-50% of visitors)
  ‚Üì
Purchase (10-16% of visitors)
```

---

### D) Dashboard queries (Supabase)

**Query 1: Conversion funnel**
```sql
WITH funnel AS (
  SELECT
    result_id,
    MAX(CASE WHEN event_name = 'softupsell_click' THEN 1 ELSE 0 END) as clicked_softupsell,
    MAX(CASE WHEN event_name = 'pricing_select' THEN 1 ELSE 0 END) as selected_pricing,
    MAX(CASE WHEN event_name = 'checkout_start' THEN 1 ELSE 0 END) as started_checkout,
    MAX(CASE WHEN event_name = 'purchase' THEN 1 ELSE 0 END) as completed_purchase
  FROM analytics_events
  WHERE created_at >= NOW() - INTERVAL '14 days'
  GROUP BY result_id
)
SELECT
  COUNT(*) as total_visitors,
  SUM(clicked_softupsell) as softupsell_clicks,
  SUM(selected_pricing) as pricing_selects,
  SUM(started_checkout) as checkout_starts,
  SUM(completed_purchase) as purchases,
  ROUND(100.0 * SUM(clicked_softupsell) / COUNT(*), 2) as softupsell_ctr,
  ROUND(100.0 * SUM(completed_purchase) / COUNT(*), 2) as conversion_rate
FROM funnel;
```

**Query 2: Sticky CTA performance**
```sql
SELECT
  properties->>'copy_variant' as cta_copy,
  COUNT(*) as shows,
  SUM(CASE WHEN event_name = 'sticky_click' THEN 1 ELSE 0 END) as clicks,
  ROUND(100.0 * SUM(CASE WHEN event_name = 'sticky_click' THEN 1 ELSE 0 END) / COUNT(*), 2) as ctr
FROM analytics_events
WHERE event_name IN ('sticky_show', 'sticky_click')
  AND created_at >= NOW() - INTERVAL '7 days'
GROUP BY properties->>'copy_variant'
ORDER BY ctr DESC;
```

**Query 3: Accordion engagement**
```sql
SELECT
  properties->>'chakra' as chakra,
  COUNT(*) as opens,
  AVG((properties->>'position')::int) as avg_position
FROM analytics_events
WHERE event_name = 'accordion_open'
  AND created_at >= NOW() - INTERVAL '7 days'
GROUP BY properties->>'chakra'
ORDER BY opens DESC;
```

**Query 4: Pricing decoy effectiveness**
```sql
SELECT
  properties->>'product_id' as product,
  COUNT(*) as selects,
  SUM(CASE WHEN (properties->>'is_decoy')::boolean THEN 1 ELSE 0 END) as decoy_selects,
  ROUND(100.0 * COUNT(*) / SUM(COUNT(*)) OVER (), 2) as percentage
FROM analytics_events
WHERE event_name = 'pricing_select'
  AND created_at >= NOW() - INTERVAL '14 days'
GROUP BY properties->>'product_id'
ORDER BY selects DESC;
```

---

## 8. Rollback & Contingency Plan

### A) Rollback triggerek

**Azonnal rollback, ha**:
1. Mobile conversion rate **>10% cs√∂kken√©s** az els≈ë 3 napban
2. Bounce rate **>15% n√∂veked√©s**
3. Checkout start rate **>20% cs√∂kken√©s**
4. Critical bug (pl. payment flow elromlik)
5. Page load time **>5s** mobilon (performance regression)

---

### B) Rollback l√©p√©sek

**Vercel Feature Flag alap√∫**:
```typescript
// /lib/feature-flags.ts
export const FEATURE_FLAGS = {
  v21_free_summary: process.env.NEXT_PUBLIC_FF_V21_FREE_SUMMARY === 'true',
  v21_sticky_cta: process.env.NEXT_PUBLIC_FF_V21_STICKY_CTA === 'true',
  v21_mobile_accordion: process.env.NEXT_PUBLIC_FF_V21_MOBILE_ACCORDION === 'true',
  v21_pricing_decoy: process.env.NEXT_PUBLIC_FF_V21_PRICING_DECOY === 'true',
};

// Result page.tsx
import { FEATURE_FLAGS } from '@/lib/feature-flags';

{FEATURE_FLAGS.v21_free_summary && (
  <FreeChakraSummary />
)}
```

**Rollback folyamat**:
1. Vercel dashboard ‚Üí Environment Variables
2. `NEXT_PUBLIC_FF_V21_FREE_SUMMARY=false` (vagy adott feature)
3. Redeploy (1-2 perc)
4. Analytics monitoring: metrik√°k vissza√°lltak-e?

**Teljes rollback** (ha minden feature probl√©m√°s):
- Git revert commit
- Redeploy `main` branch el≈ëz≈ë √°llapot√°ra

---

### C) R√©szleges rollback strat√©gia

Ha csak **egy feature** probl√©m√°s:
- **Free Summary rossz**: Elrejt, Soft-Upsell megtart√°sa
- **Sticky CTA agressz√≠v**: Trigger 30% ‚Üí 50% m√≥dos√≠t√°s
- **Mobile Accordion zavar√≥**: Desktop all-expanded mobilra is
- **Pricing Decoy nem m≈±k√∂dik**: Decoy kiemel√©s elt√°vol√≠t√°sa, 3 k√°rtya megmarad

---

### D) Monitoring checklist (els≈ë 7 nap)

**Napi check**:
- [ ] Conversion rate trend (Plausible)
- [ ] Error rate (Vercel Function Logs)
- [ ] Supabase events t√°bl√°zat: adatok folyamatosan j√∂nnek?
- [ ] User feedback (email, support tickets)

**3. nap √°tfog√≥ review**:
- [ ] Funnel analysis (softupsell ‚Üí pricing ‚Üí checkout ‚Üí purchase)
- [ ] Device breakdown: mobile vs desktop performance
- [ ] Browser compatibility issues?

**7. nap d√∂nt√©si pont**:
- [ ] Ha metrik√°k pozit√≠vak ‚Üí A/B teszt f√°zis ind√≠t√°sa (sticky trigger)
- [ ] Ha metrik√°k negat√≠vak ‚Üí Rollback + post-mortem analysis

---

## 9. Dependencies & Prerequisites

### A) Technikai el≈ëfelt√©telek

**Sz√ºks√©ges**:
- ‚úÖ Node.js 18+ (jelenlegi projekt)
- ‚úÖ Next.js 14 App Router (jelenlegi projekt)
- ‚úÖ TypeScript (jelenlegi projekt)
- ‚úÖ Tailwind CSS (jelenlegi projekt)
- ‚úÖ Framer Motion (jelenlegi projekt)
- ‚úÖ Supabase client (jelenlegi projekt)

**Telep√≠tend≈ë**:
- [ ] Plausible Analytics script (`app/layout.tsx`-ba)
- [ ] Vercel Edge Config (dashboard setup)

---

### B) Adatb√°zis migr√°ci√≥

**SQL migration f√°jl**: `/supabase/migrations/20251017_analytics_events.sql`

```sql
-- Create analytics_events table
CREATE TABLE IF NOT EXISTS analytics_events (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  result_id UUID REFERENCES quiz_results(id) ON DELETE CASCADE,
  event_name TEXT NOT NULL,
  properties JSONB DEFAULT '{}'::jsonb,
  session_id TEXT,
  user_agent TEXT,
  device_type TEXT CHECK (device_type IN ('mobile', 'tablet', 'desktop')),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Create indexes
CREATE INDEX idx_analytics_events_result ON analytics_events(result_id);
CREATE INDEX idx_analytics_events_name ON analytics_events(event_name);
CREATE INDEX idx_analytics_events_created ON analytics_events(created_at DESC);
CREATE INDEX idx_analytics_events_device ON analytics_events(device_type);

-- Enable RLS
ALTER TABLE analytics_events ENABLE ROW LEVEL SECURITY;

-- RLS Policy: Allow public insert (anonymous tracking)
CREATE POLICY "Allow public insert for analytics" ON analytics_events
  FOR INSERT
  WITH CHECK (true);

-- RLS Policy: Allow authenticated read (admin dashboard)
CREATE POLICY "Allow authenticated read for analytics" ON analytics_events
  FOR SELECT
  USING (auth.role() = 'authenticated');
```

**Futtat√°s**: Supabase dashboard ‚Üí SQL Editor ‚Üí Run

---

### C) Environment variables

**√öj v√°ltoz√≥k** (`.env.local`):
```bash
# Plausible Analytics (k√©s≈ëbb)
NEXT_PUBLIC_PLAUSIBLE_DOMAIN=eredeticsakra.hu

# Vercel Edge Config (k√©s≈ëbb, A/B teszthez)
EDGE_CONFIG=https://edge-config.vercel.com/ecfg_xxx

# Feature Flags (rollback control)
NEXT_PUBLIC_FF_V21_FREE_SUMMARY=true
NEXT_PUBLIC_FF_V21_STICKY_CTA=true
NEXT_PUBLIC_FF_V21_MOBILE_ACCORDION=true
NEXT_PUBLIC_FF_V21_PRICING_DECOY=true
```

**Vercel Production**: Ugyanezeket be√°ll√≠tani dashboard-on

---

## 10. Risk Analysis & Mitigation

### Kock√°zat 1: Free Summary t√∫l sok inform√°ci√≥t ad ingyen
**Val√≥sz√≠n≈±s√©g**: K√∂zepes
**Hat√°s**: K√∂zepes (cs√∂kken≈ë fizet≈ës konverzi√≥)
**Mitig√°ci√≥**:
- Csak 1 chakra k√°rtya (legfontosabb), nem mind a 7
- Tipp egyszer≈±, "taster", r√©szletes terv a fizet≈ësben
- Soft-Upsell Box azonnal kontextust ad

---

### Kock√°zat 2: Sticky CTA ideges√≠t≈ë, dismiss rate magas
**Val√≥sz√≠n≈±s√©g**: K√∂zepes
**Hat√°s**: Alacsony (dismissible funkci√≥ megoldja)
**Mitig√°ci√≥**:
- Dismiss gomb j√≥l l√°that√≥
- localStorage: 24h-ig nem jelenik meg √∫jra
- A/B teszt: 30% scroll vs 12s id≈ë trigger

---

### Kock√°zat 3: Mobile Accordion t√∫l "rejtett", nem nyitj√°k ki
**Val√≥sz√≠n≈±s√©g**: Alacsony
**Hat√°s**: K√∂zepes (engagement cs√∂kken√©s)
**Mitig√°ci√≥**:
- Visual cue: Chevron ikon + "B≈ëvebben" sz√∂veg
- Els≈ë k√°rtya auto-open opci√≥ (A/B teszt)
- Micro-animation: Pulse effect els≈ë k√°rty√°n

---

### Kock√°zat 4: Pricing Decoy "t√∫l j√≥", mindenki Bundle-t vesz
**Val√≥sz√≠n≈±s√©g**: Magas (ez a c√©l!)
**Hat√°s**: Pozit√≠v (magasabb AOV)
**Megjegyz√©s**: Ez nem kock√°zat, hanem sikerkrit√©rium

---

### Kock√°zat 5: Performance regresszi√≥ (LCP, CLS)
**Val√≥sz√≠n≈±s√©g**: K√∂zepes
**Hat√°s**: Magas (SEO + UX k√°rosodik)
**Mitig√°ci√≥**:
- Lazy loading komponensek (below the fold)
- Framer Motion: `layoutId` optimaliz√°l√°s
- Image optimization: Silhouette SVG (nem bitmap)
- Lighthouse audit minden deploy el≈ëtt

---

### Kock√°zat 6: Analytics adatok nem pontosak
**Val√≥sz√≠n≈±s√©g**: Alacsony
**Hat√°s**: K√∂zepes (d√∂nt√©si bizonytalans√°g)
**Mitig√°ci√≥**:
- Double tracking: Supabase + Plausible
- Manual QA: Event fire-ok b√∂ng√©sz≈ë consolban
- Cross-reference Stripe purchase data-val

---

## 11. Post-Launch Activities

### Week 1-2: Stability Monitoring
- [ ] Daily conversion rate check (Plausible)
- [ ] Error monitoring (Vercel logs)
- [ ] User feedback gy≈±jt√©s (email, support)
- [ ] Performance metrics (Lighthouse, Vercel Analytics)

### Week 3-4: Data Analysis
- [ ] Funnel analysis (Supabase queries)
- [ ] Heatmap (Hotjar vagy hasonl√≥ - opcion√°lis)
- [ ] Session recordings (3-5 user journey vide√≥)
- [ ] Device/browser breakdown

### Week 5: Optimization Round 1
- [ ] Copy tweaks (CTA sz√∂vegek A/B)
- [ ] Visual refinements (sz√≠nek, spacing)
- [ ] Trust badges poz√≠ci√≥ optimaliz√°l√°s
- [ ] Sticky CTA trigger finomhangol√°s

### Month 2: A/B Testing Phase
- [ ] Sticky trigger A/B (scroll vs time)
- [ ] Accordion default A/B (0 vs 1 open)
- [ ] Soft-upsell position A/B (top vs bottom)

### Month 3: Advanced Features
- [ ] Real-time social proof counter
- [ ] Exit-intent popup (mobile-friendly)
- [ ] Personalized CTA copy (ML-based)
- [ ] Email remarketing (abandoned result page)

---

## 12. Kapcsol√≥d√≥ Dokumentumok

- [Project Structure](/docs/ai-context/project-structure.md) - Teljes file tree √©s tech stack
- [V1.5 Development Plan](/docs/v1.5-DEVELOPMENT-PLAN.md) - El≈ëz≈ë fejleszt√©si f√°zis
- [CLAUDE.md](/CLAUDE.md) - AI context √©s projekt overview
- [Quiz Interpretations](/lib/quiz/interpretations.ts) - Chakra scoring logika
- [Stripe Products](/lib/stripe/products.ts) - Term√©kek √©s √°raz√°s

---

## 13. Q&A / D√∂nt√©si Pontok

### Megv√°laszolt k√©rd√©sek

‚úÖ **Free Summary: Melyik chakr√°t mutassuk?**
‚Üí **A) Legnagyobb blokk**, pozit√≠v micro-copy-val. Fallback: Gy√∂k√©rcsakra.

‚úÖ **Soft-upsell poz√≠ci√≥: Top vs Bottom?**
‚Üí **Top poz√≠ci√≥** megy √©lesbe, Bottom k√©s√∂bbi A/B teszthez k√©sz√≠tve.

‚úÖ **Pricing: H√°ny k√°rtya? Melyik a decoy?**
‚Üí **3 k√°rtya**: PDF (2990) | AJ√ÅNLOTT Bundle (6990) | Pr√©mium (k√©s≈ëbbi). Bundle a c√©l.

‚úÖ **Analytics eszk√∂z?**
‚Üí **Plausible + Supabase events t√°bla** kombin√°ci√≥.

‚úÖ **A/B infrastrukt√∫ra?**
‚Üí **Vercel Edge Config + localStorage**. Lightweight, query param override support.

---

### Nyitott k√©rd√©sek (implement√°ci√≥ k√∂zben eld√∂ntend≈ë)

‚ùì **Trust badges: Pontos poz√≠ci√≥ minden n-edik k√°rtya ut√°n?**
‚Üí Javaslat: 2-3 k√°rtya ut√°n, shuffle order

‚ùì **Sticky CTA dismiss: 24h vs 7 nap localStorage persistence?**
‚Üí Javaslat: 24h (nem t√∫l agressz√≠v)

‚ùì **Pricing Pr√©mium csomag tartalma?**
‚Üí User d√∂nt√©s: Bundle + 1:1 konzult√°ci√≥? Vagy Bundle + email support?

‚ùì **Real-time social proof: Val√≥s adat vagy statikus?**
‚Üí Javaslat: Statikus first (2000+), real-time later (Month 3)

---

## 14. √ñsszegz√©s

A v2.1 Result Page optimization egy **CRO-f√≥kusz√∫, adatvez√©relt, progressz√≠v fejleszt√©s**, amely a mobil konverzi√≥s funnel legnagyobb f√°jdalompontjait c√©lozza:

1. **Above-fold √©rt√©kad√°s**: Free Summary + Soft-Upsell (pozit√≠v els≈ë benyom√°s)
2. **Scroll depth cs√∂kkent√©s**: Mobile Accordion (10k ‚Üí 3k px, -70%)
3. **CTA el√©rhet≈ës√©g**: Sticky CTA (30% scrolln√°l, +27% lift)
4. **Bizalom√©p√≠t√©s**: In-content Trust Badges (folyamatos megnyugtat√°s)
5. **Decoy pricing**: Bundle mint "no-brainer" aj√°nlat (50%+ click rate c√©l)
6. **Data-driven iter√°ci√≥**: Analytics + A/B testing (folyamatos optimaliz√°l√°s)

**V√°rhat√≥ eredm√©ny**: +40-55% mobil konverzi√≥ n√∂veked√©s, -20% scroll depth a CTA-hoz, +25% above-fold engagement.

**Timeline**: 4-6 nap implement√°ci√≥, 14 nap baseline m√©r√©s, 6-8 h√©t A/B teszt f√°zis.

**Rollback**: Feature flag alap√∫, b√°rmely komponens 2 perc alatt elrejthet≈ë.

---

**St√°tusz**: ‚úÖ J√ìV√ÅHAGYVA - Implement√°ci√≥ indulhat
**K√∂vetkez≈ë l√©p√©s**: Phase 1 - FreeChakraSummary.tsx komponens fejleszt√©se
**Felel≈ës**: Szabolcs + AI Agent
**Deadline**: Phase 1-2 (Core + Conversion Boosters) ‚Üí 5 nap
